<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Smoking & Alcohol Detection</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-dark text-light">

<div class="container py-5">
    <h2 class="text-center mb-4">üö¨ü•Ç Smoking, Alcohol & Abusive Language Detection</h2>

    <form method="POST" enctype="multipart/form-data" class="mb-5">
        <div class="mb-3">
            <input type="file" name="file" accept="image/*,video/*" class="form-control" required>
        </div>
        <button type="submit" class="btn btn-primary w-100">Upload & Detect</button>
        <div class="text-center my-3" id="loading" style="display: none;">
    <div class="spinner-border text-light" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
    <p>Processing, please wait...</p>
</div>

    </form>

    {% if result %}
    <div class="card bg-secondary text-light mb-4">
        <div class="card-body">
            <h5 class="card-title">Results for: <b>{{ result.filename }}</b> ({{ result.file_type }})</h5>
            <hr>

            {% if result.file_type == 'image' %}
                <img src="/{{ result.file_url }}" class="img-fluid mb-3 rounded" style="max-height: 300px;">
            {% elif result.file_type == 'video' %}
                <video src="/{{ result.file_url }}" class="img-fluid mb-3 rounded" controls style="max-height: 300px;"></video>
            {% endif %}

            {% if result.neutral %}
                <h4 class="text-center text-info">‚úÖ No Smoking or Alcohol Detected (Neutral Scene)</h4>
            {% else %}
                <div class="row text-center">
                    <div class="col">
                        <h6>Smoking</h6>
                        {% if result.smoking %}
                            <span class="badge bg-danger">Detected</span>
                        {% else %}
                            <span class="badge bg-success">Not Detected</span>
                        {% endif %}
                        <p>Confidence: {{ result.smoking_prob }}</p>
                    </div>
                    <div class="col">
                        <h6>Alcohol</h6>
                        {% if result.alcohol %}
                            <span class="badge bg-danger">Detected</span>
                        {% else %}
                            <span class="badge bg-success">Not Detected</span>
                        {% endif %}
                        <p>Confidence: {{ result.alcohol_prob }}</p>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>

    {% if result.abuse_label %}
    <div class="card bg-dark border-info text-light">
        <div class="card-body">
            <h5 class="card-title">üó£Ô∏è Abusive Language Detection (from Audio)</h5>
            <p><strong>Detected:</strong> {{ result.abuse_label }}</p>
            <p><strong>Transcription:</strong> {{ result.transcribed_text }}</p>
        </div>
    </div>
    {% endif %}

    {% endif %}
</div>
<script>
    const form = document.querySelector("form");
    const loading = document.getElementById("loading");

    form.addEventListener("submit", function () {
        loading.style.display = "block";
    });
</script>

</body>
</html>
